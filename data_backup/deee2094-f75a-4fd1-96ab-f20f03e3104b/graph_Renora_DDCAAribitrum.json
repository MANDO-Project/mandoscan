{
  "nodes": [
    {
      "id": "1",
      "label": "Node 1",
      "node_type": "Function Declaration",
      "group": "A",
      "code_lines": "6-62",
      "message": "Bug: Reentrancy\nReason: If the token being approved has a fallback function, it could lead to reentrancy attacks.\n Suggestion: Consider implementing the Checks-Effects-Interactions pattern to mitigate reentrancy risks."
    },
    {
      "id": "2",
      "label": "Node 2",
      "node_type": "Expression",
      "group": "B",
      "code_lines": "7-7",
      "message": ""
    },
    {
      "id": "3",
      "label": "Node 3",
      "node_type": "Function Declaration",
      "group": "C",
      "code_lines": "8-14",
      "message": "Bug: Reentrancy\nReason: If the token being approved has a fallback function, it could lead to reentrancy attacks.\n Suggestion: Consider implementing the Checks-Effects-Interactions pattern to mitigate reentrancy risks."
    },
    {
      "id": "4",
      "label": "Node 4",
      "node_type": "Expression",
      "group": "D",
      "code_lines": "13-13",
      "message": ""
    },
    {
      "id": "5",
      "label": "Node 5",
      "node_type": "Function Declaration",
      "group": "E",
      "code_lines": "15-41",
      "message": "Bug: Timestamp Dependency\nReason: Using `block.timestamp` can lead to front-running attacks where an attacker can manipulate the transaction order based on the timestamp.\n Suggestion: Use a block number or a more deterministic method to set deadlines."
    },
    {
      "id": "6",
      "label": "Node 6",
      "node_type": "Expression",
      "group": "F",
      "code_lines": "20-30",
      "message": "Bug: Timestamp Dependency\nReason: Using `block.timestamp` can lead to front-running attacks where an attacker can manipulate the transaction order based on the timestamp.\n Suggestion: Use a block number or a more deterministic method to set deadlines."
    },
    {
      "id": "7",
      "label": "Node 7",
      "node_type": "Expression",
      "group": "G",
      "code_lines": "31-40",
      "message": ""
    },
    {
      "id": "8",
      "label": "Node 8",
      "node_type": "Expression",
      "group": "H",
      "code_lines": "32-37",
      "message": ""
    },
    {
      "id": "9",
      "label": "Node 9",
      "node_type": "Function Declaration",
      "group": "A",
      "code_lines": "42-61",
      "message": "Bug: Arithmetic\nReason: If `ratio` or `bal` are large, this could lead to an overflow or underflow.\n Suggestion: Use SafeMath library functions to handle arithmetic operations safely."
    },
    {
      "id": "10",
      "label": "Node 10",
      "node_type": "Expression",
      "group": "B",
      "code_lines": "47-47",
      "message": ""
    },
    {
      "id": "11",
      "label": "Node 11",
      "node_type": "if",
      "group": "C",
      "code_lines": "48-50",
      "message": "Bug: Arithmetic\nReason: If `amountIn` is large and the denominator is small, this could lead to an overflow or underflow.\n Suggestion: Use SafeMath library functions to handle arithmetic operations safely."
    },
    {
      "id": "12",
      "label": "Node 12",
      "node_type": "End If",
      "group": "D",
      "code_lines": "",
      "message": ""
    },
    {
      "id": "13",
      "label": "Node 13",
      "node_type": "Expression",
      "group": "E",
      "code_lines": "51-53",
      "message": ""
    },
    {
      "id": "14",
      "label": "Node 14",
      "node_type": "Expression",
      "group": "F",
      "code_lines": "54-58",
      "message": ""
    },
    {
      "id": "15",
      "label": "Node 15",
      "node_type": "Expression",
      "group": "G",
      "code_lines": "59-59",
      "message": ""
    },
    {
      "id": "16",
      "label": "Node 16",
      "node_type": "Expression",
      "group": "H",
      "code_lines": "60-60",
      "message": ""
    }
  ],
  "links": [
    {
      "source": "1",
      "target": "2",
      "label": "Edge 1",
      "edge_type": "Next"
    },
    {
      "source": "2",
      "target": "3",
      "label": "Edge 2",
      "edge_type": "Next"
    },
    {
      "source": "3",
      "target": "4",
      "label": "Edge 3",
      "edge_type": "Next"
    },
    {
      "source": "4",
      "target": "5",
      "label": "Edge 4",
      "edge_type": "Next"
    },
    {
      "source": "5",
      "target": "6",
      "label": "Edge 5",
      "edge_type": "Next"
    },
    {
      "source": "6",
      "target": "7",
      "label": "Edge 6",
      "edge_type": "Next"
    },
    {
      "source": "7",
      "target": "8",
      "label": "Edge 7",
      "edge_type": "Next"
    },
    {
      "source": "8",
      "target": "9",
      "label": "Edge 8",
      "edge_type": "Next"
    },
    {
      "source": "9",
      "target": "10",
      "label": "Edge 9",
      "edge_type": "Next"
    },
    {
      "source": "10",
      "target": "11",
      "label": "Edge 10",
      "edge_type": "Next"
    },
    {
      "source": "11",
      "target": "12",
      "label": "Edge 11",
      "edge_type": "Next"
    },
    {
      "source": "12",
      "target": "13",
      "label": "Edge 12",
      "edge_type": "Next"
    },
    {
      "source": "13",
      "target": "14",
      "label": "Edge 13",
      "edge_type": "Next"
    },
    {
      "source": "14",
      "target": "15",
      "label": "Edge 14",
      "edge_type": "Next"
    },
    {
      "source": "15",
      "target": "16",
      "label": "Edge 15",
      "edge_type": "Next"
    }
  ]
}